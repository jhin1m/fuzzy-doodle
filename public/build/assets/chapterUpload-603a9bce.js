import{$ as c}from"./dropzone-f13a1568.js";c.autoDiscover=!1;document.addEventListener("DOMContentLoaded",()=>{const r=document.querySelector("#submit-chapter"),i=document.querySelector("[name='title']"),l=document.querySelector("[name='manga_id']"),d=document.querySelector("[name='chapter_number']");let s=0;const n=new c("#dropzone",{url:uploadUrl,method:"POST",headers:{"X-CSRF-TOKEN":csrfToken},autoProcessQueue:!0,parallelUploads:1,addRemoveLinks:!0,acceptedFiles:"image/*,.zip",success:function(t,e){t.previewElement.dataset.image=e.filename},error:function(t,e){console.error(e)}});n.on("sending",(t,e)=>{const o=e.onload;e.onload=function(a){o(a)}}),n.on("complete",async t=>{s++,s===n.files.length&&(r.disabled=!1,r.addEventListener("click",m))});const m=async t=>{t.preventDefault();let e=[];n.files.forEach(o=>{e.push(o.previewElement.dataset.image)});try{const a=await(await fetch(postUrl,{method:"POST",body:JSON.stringify({title:i.value,manga_id:l.value,chapter_number:d.value,files:e}),headers:{"Content-Type":"application/json","X-CSRF-TOKEN":csrfToken}})).json();(a.success||a.error)&&(window.location.href=urlRedirect)}catch(o){console.error(o)}};n.on("removedfile",u);async function u(t){try{await fetch(uploadUrl,{method:"DELETE",body:JSON.stringify({filename:t.previewElement.dataset.image}),headers:{"Content-Type":"application/json","X-CSRF-TOKEN":csrfToken}})}catch(e){console.error(e)}}});
